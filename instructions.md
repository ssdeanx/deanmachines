# Final Nx Migration Guide (Purely Manual File Copy & Configuration) - v2.5

Document Version: 2.5
Generated By: Codex Advanced Analytical Assistant
Date: April 10, 2025
Meta-Information:
Unique IDs ({id="..."}): For precise referencing.
Tags ((#tag)): For categorization and context.

## I. Goal & Context Statement {id="goal-context-manual-pure"}

Primary Goal: To provide an exhaustive, step-by-step manual guide for migrating Project A (Next.js frontend) and Project B (Mastra AI backend) into a functional Nx monorepo by manually creating directories, copying files, and manually creating/editing all necessary configuration files. (#objective)
Specific Projects:
Project A: C:\Users\dm\Documents\deanmachines-front {id="project-a-path-manual"} (#frontend)
Project B: C:\Users\dm\Documents\DeanmachinesAI {id="project-b-path-manual"} (#backend)
Target Monorepo Root: C:\Users\dm\Documents\deanmachines\deanmachines {id="monorepo-root-path-manual"}
Target Audience: Developer executing the migration manually; AI Assistants needing context. (#audience)
Methodology: Manual file/folder creation and copying using Windows File Explorer or terminal commands (mkdir, xcopy, copy). Manual creation and editing of all configuration files (nx.json, package.json, project.json, tsconfig.*.json, etc.) in a text editor. Manual execution of pnpm install and nx build/serve. (#methodology)
Desired Outcome: A functional Nx monorepo containing both migrated applications, configured correctly for Nx. {id="desired-outcome-manual-pure"}

## II. Prerequisites {id="prerequisites-manual-pure"}

Dependencies:
Node.js: >= 18 installed & in PATH. (#dependency)
pnpm: Installed & in PATH. (#dependency)
Git: Installed & in PATH. (#dependency)
ts-node: Installed globally & in PATH (for dep analysis only). (#dependency)
nx CLI: Installed globally (pnpm add -g nx). (#dependency)
Original Projects: Exist at specified paths.
Backups: Complete local backups exist. {id="backup-req-manual"}
Cleanup: Original projects cleaned. {id="cleanup-req-manual"}
Dependency Analysis Script: analyze-deps.ts saved (e.g., C:\Users\dm\Documents\MigrationTools\analyze-deps.ts). {id="dep-script-req-manual"}
Dependency Resolution Plan: dep-analysis.txt output generated, and conflict versions decided. {id="dep-plan-req-manual"}
Terminal: Command Prompt (CMD) or PowerShell, Run as Administrator. {id="terminal-req-manual"}
Text Editor: VS Code, Notepad++, etc.

## Phase 0: Final Preparation {id="migration-final-prep-manual-pure"} (#migration-prep)

Step 0.1: Verify Backups {id="migration-final-0-1-manual-pure"}: Confirm backups.
Step 0.2: Verify Cleanup {id="migration-final-0-2-manual-pure"}: Confirm original repos clean.
Step 0.3: Run Dependency Analysis {id="migration-final-0-3-manual-pure"}: (#dependencies)

Action (User - Terminal):
:: Create the parent directory if it doesn't exist
if not exist "C:\Users\dm\Documents\deanmachines" mkdir "C:\Users\dm\Documents\deanmachines"
:: Create the monorepo root directory (will be empty initially)
if not exist "C:\Users\dm\Documents\deanmachines\deanmachines" mkdir "C:\Users\dm\Documents\deanmachines\deanmachines"

:: Run the analysis script (UPDATE PATH TO SCRIPT if different)
ts-node "C:\Users\dm\Documents\MigrationTools\analyze-deps.ts" "C:\Users\dm\Documents\deanmachines-front\package.json" "C:\Users\dm\Documents\DeanmachinesAI\package.json" > "C:\Users\dm\Documents\deanmachines\deanmachines\dep-analysis.txt"
Use code with caution.
Cmd
Action (User - Editor): Open C:\Users\dm\Documents\deanmachines\deanmachines\dep-analysis.txt. Review and document your chosen version for every conflict.
Step 0.4: Configure Git Line Endings {id="migration-final-0-4-manual-pure"}: (#git) (#best-practice)

Action (User - Terminal):

```bash
git config --global core.autocrlf true
git config --global core.eol lf
```

## Phase 1: Manual Nx Workspace Setup {id="migration-final-phase-1-manual-pure"} (#migration-setup) (#config)

Navigate into Monorepo Root {id="migration-final-1-1-manual-pure"}:
cd /d C:\Users\dm\Documents\deanmachines\deanmachines
Use code with caution.
Cmd
Manual Step: Create Root package.json {id="migration-final-1-2-manual-pure"}: (#dependencies)
Action (User - Editor): Create a new file named package.json in the root (C:\Users\dm\Documents\deanmachines\deanmachines).
Action: Populate it by merging dependencies. Start with a basic structure and add from your dep-analysis.txt / Resolution Plan:

```json
{
  "name": "deanmachines", // Your chosen monorepo name
  "version": "0.0.0",
  "license": "MIT", // Or your license
  "private": true,
  "scripts": {
    // Add basic Nx scripts later if desired, e.g., "build": "nx affected:build"
  },
  "dependencies": {
    // Add ALL "Unique to Project A" dependencies here
    // Add ALL "Unique to Project B" dependencies here
    // Add ALL "Shared & Aligned" dependencies here
    // Add ALL "Conflict" dependencies using your CHOSEN version here
    // Example: "zod": "^3.24.2" // Your chosen version
  },
  "devDependencies": {
    "nx": "latest", // Add Nx itself
    "@nx/devkit": "latest",
    "@nx/eslint": "latest", // Assuming ESLint plugin
    "@nx/jest": "latest", // Assuming Jest plugin
    "@nx/js": "latest", // Core JS/TS plugin
    "@nx/next": "latest", // For frontend
    "@nx/node": "latest", // For backend
    "@nx/workspace": "latest", // Core workspace plugin
    "eslint": "~8.57.0", // Example base version
    "prettier": "^3.2.5", // Example base version
    "typescript": "~5.4.0", // Example base version
    // Add ALL "Unique to Project A" devDependencies here
    // Add ALL "Unique to Project B" devDependencies here
    // Add ALL "Shared & Aligned" devDependencies here
    // Add ALL "Conflict" devDependencies using your CHOSEN version here
  }
}
```

Action: Save package.json.
Manual Step: Create nx.json {id="migration-final-1-3-manual-pure"}:
Action (User - Editor): Create nx.json in the root.
Action: Add basic configuration. We will add more details later.

```json
{
  "$schema": "./node_modules/nx/schemas/nx-schema.json",
  "affected": {
    "defaultBase": "main" // Or your default branch
  },
  "targetDefaults": { // Add basic caching for build
    "build": {
      "cache": true,
      "dependsOn": ["^build"], // Build dependencies first
      "inputs": ["default", "^default"], // Default inputs for caching
      "outputs": ["{options.outputPath}"] // Cache based on output path option
    }
  },
  "namedInputs": { // Define basic input sets
    "default": ["{projectRoot}/**/*", "sharedGlobals"],
    "production": [
      "default",
      "!{projectRoot}/**/*.spec.ts",
      "!{projectRoot}/**/*.test.ts",
      "!{projectRoot}/jest.config.ts"
    ],
    "sharedGlobals": [ // Files affecting all projects
      "{workspaceRoot}/package.json",
      "{workspaceRoot}/tsconfig.base.json",
      "{workspaceRoot}/pnpm-lock.yaml",
      "{workspaceRoot}/nx.json"
    ]
  },
  "workspaceLayout": { // Define structure
    "appsDir": "apps",
    "libsDir": "libs"
  },
  "plugins": [] // Add "plugins": [...] later if needed for inference
}
```

Action: Save nx.json.
Manual Step: Create tsconfig.base.json {id="migration-final-1-4-manual-pure"}: (#typescript)
Action (User - Editor): Create tsconfig.base.json in the root.
Action: Add base TypeScript configuration.

```json
{
  "compileOnSave": false,
  "compilerOptions": {
    "rootDir": ".",
    "sourceMap": true,
    "declaration": false,
    "moduleResolution": "node", // Or "bundler" if preferred
    "emitDecoratorMetadata": true,
    "experimentalDecorators": true,
    "importHelpers": true,
    "target": "ES2021", // Or your preferred target
    "module": "ESNext", // Or CommonJS if needed by backend
    "lib": ["ES2021", "DOM"],
    "skipLibCheck": true,
    "skipDefaultLibCheck": true,
    "baseUrl": ".",
    "paths": {
      // Library paths will be added here manually later
    },
    "esModuleInterop": true,
    "strict": true // Recommended
    // Add other shared compiler options
  },
  "exclude": ["node_modules", "tmp", "dist"]
}
```

Action: Save tsconfig.base.json.
Manual Step: Create pnpm-workspace.yaml {id="migration-final-1-5-manual-pure"}: (#dependencies)
Action (User - Editor): Create pnpm-workspace.yaml in the root.

Action: Define the workspace packages:

```yaml
packages:
- 'apps/*'
- 'libs/*'
```

Action: Save pnpm-workspace.yaml.
Manual Step: Create Root .gitignore {id="migration-final-1-6-manual-pure"}:
Action (User - Editor): Create .gitignore in the root.
Action: Copy/merge ignores from original projects and add Nx specifics (see Phase 1, Step 1.2 above). Save.
Install Dependencies {id="migration-final-1-7-manual-pure"}:

```bash
pnpm install

```

Troubleshooting: Fix any errors, especially peer dependency conflicts. Adjust versions in package.json and re-run pnpm install if needed.
Manual Step: Initial Git Commit {id="migration-final-1-8-manual-pure"}: (#git)
Action (User - Terminal):

```bash
git init
git add .
git commit -m "chore(workspace): Manual Nx setup and dependency merge"
```

## Phase 2: Manual Backend Migration (apps/backend) {id="manual-migrate-backend-pure"} (#migration-backend)

Manual Step: Create Directories {id="manual-backend-create-dirs-pure"}:
Action (User - File Explorer/Terminal): Create the following directory structure:

apps\backend
apps\backend\src
apps\backend\knowledge
Manual Step: Copy Backend Code & Assets {id="manual-backend-copy-code-pure"}:
Action (User - File Explorer/Terminal):
Copy contents of C:\Users\dm\Documents\DeanmachinesAI\src\mastra\ into apps\backend\src\.
Copy contents of C:\Users\dm\Documents\DeanmachinesAI\knowledge\ into apps\backend\knowledge\.
Copy C:\Users\dm\Documents\DeanmachinesAI\mastra.config.ts into apps\backend\src\.
Copy C:\Users\dm\Documents\DeanmachinesAI\api.json into apps\backend\.
Manual Step: Create & Configure apps/backend/project.json {id="manual-backend-config-projjson-pure"}: (#config-projectjson)
Action (User - Editor): Create apps\backend\project.json.
Action: Populate with the necessary configuration:
```json
{
  "name": "backend", // Must match directory name
  "$schema": "../../node_modules/nx/schemas/project-schema.json",
  "sourceRoot": "apps/backend/src",
  "projectType": "application",
  "tags": ["scope:backend", "type:app"],
  "targets": {
    "build": {
      "executor": "@nx/js:tsc",
      "outputs": ["{options.outputPath}"],
      "options": {
        "outputPath": "dist/apps/backend",
        "main": "apps/backend/src/index.ts", // <<< VERIFY/UPDATE Entry Point
        "tsConfig": "apps/backend/tsconfig.app.json",
        "assets": [
          "apps/backend/api.json",
          {"glob": "**/*", "input": "apps/backend/knowledge", "output": "./knowledge"}
        ],
        "clean": true
      },
      "configurations": { "production": { /* Prod options */ } }
    },
    "serve": {
      "executor": "@nx/js:node",
      "options": { "buildTarget": "backend:build" },
      "configurations": { "production": { "buildTarget": "backend:build:production" } }
    },
    "lint": {
      "executor": "@nx/eslint:lint"
      // Add "options": { "lintFilePatterns": ["apps/backend/**/*.ts"] } if needed
    }
    // Add "test" target later
  }
}
```

Action: Save the file.
Manual Step: Create & Configure apps/backend/tsconfig.app.json {id="manual-backend-config-tsconfig-pure"}: (#config-tsconfig)
Action (User - Editor): Create apps\backend\tsconfig.app.json.
Action: Populate with:

```json
{
  "extends": "../../tsconfig.base.json",
  "compilerOptions": {
    "outDir": "../../dist/out-tsc",
    "module": "NodeNext",
    "target": "ES2021",
    "types": ["node"],
    "emitDecoratorMetadata": true, // If needed
    "experimentalDecorators": true // If needed
  },
  "exclude": ["node_modules", "dist", "**/*.spec.ts", "**/*.test.ts"],
  "include": ["src/**/*.ts"]
}
```

Action: Save the file.
Validate Backend Build {id="manual-backend-validate-build-pure"}: (#validation)
Action (User - Terminal): nx build backend.
Troubleshooting: Fix TS errors. Check dist\apps\backend output. Ignore "Cannot find module @deanmachines/..." for now.
Manual Step: Commit Backend Migration {id="manual-backend-commit-pure"}: (#git)
Action (User - Terminal): git add ., git commit -m "feat(backend): Manual migration of Mastra AI backend"

## Phase 3: Manual Frontend Migration (apps/frontend) {id="manual-migrate-frontend-pure"} (#migration-frontend)

Manual Step: Create Directories {id="manual-frontend-create-dirs-pure"}:
Action (User - File Explorer/Terminal): Create apps\frontend, apps\frontend\src, apps\frontend\public, apps\frontend\content.
Manual Step: Copy Frontend Code & Assets {id="manual-frontend-copy-code-pure"}:
Action (User - File Explorer/Terminal):
Copy contents of C:\Users\dm\Documents\deanmachines-front\src\ into apps\frontend\src\.
Copy contents of C:\Users\dm\Documents\deanmachines-front\public\ into apps\frontend\public\.
Copy contents of C:\Users\dm\Documents\deanmachines-front\content\ into apps\frontend\content\.
Manual Step: Copy & Adapt Config Files {id="manual-frontend-copy-adapt-configs-pure"}: (#config)
Action (User - File Explorer/Terminal): Copy postcss.config.mjs, tailwind.config.js, components.json, contentlayer.config.ts, next.config.js (or .ts/.mjs) from original frontend to apps\frontend\.
Action (User - Editor): Edit apps\frontend\next.config.js. Manually wrap the exported config with withNx() (and withContentlayer() if used). Add outputFileTracingRoot: '../../' if needed.
Action (User - Editor): Edit apps\frontend\tailwind.config.js. Update content paths relative to apps/frontend.
Action (User - Editor): Edit apps\frontend\contentlayer.config.ts. Update contentDirPath relative to apps/frontend.
Manual Step: Create & Configure apps/frontend/project.json {id="manual-frontend-config-projjson-pure"}: (#config-projectjson)
Action (User - Editor): Create apps\frontend\project.json.
Action: Populate with:

```json
{
  "name": "frontend",
  "$schema": "../../node_modules/nx/schemas/project-schema.json",
  "sourceRoot": "apps/frontend/src",
  "projectType": "application",
  "tags": ["scope:frontend", "type:app"],
  "targets": {
    "build": {
      "executor": "@nx/next:build",
      "outputs": ["{options.outputPath}"],
      "defaultConfiguration": "production",
      "options": {
        "outputPath": "dist/apps/frontend"
        // "root": "apps/frontend" // Usually inferred correctly
      },
      "configurations": { "production": {} }
    },
    "serve": {
      "executor": "@nx/next:server",
      "defaultConfiguration": "development",
      "options": {
        "buildTarget": "frontend:build",
        "dev": true
      },
      "configurations": {
        "development": { "buildTarget": "frontend:build:development", "dev": true },
        "production": { "buildTarget": "frontend:build:production", "dev": false }
      }
    },
    "lint": {
      "executor": "@nx/eslint:lint"
    }
    // Add "test", "generate-api-client" later
  }
}
```

Action: Save the file.
Manual Step: Create & Configure apps/frontend/tsconfig.app.json {id="manual-frontend-config-tsconfig-pure"}: (#config-tsconfig)
Action (User - Editor): Create apps\frontend\tsconfig.app.json.
Action: Populate with:

```json
{
  "extends": "../../tsconfig.base.json",
  "compilerOptions": {
    "outDir": "../../dist/out-tsc",
    "module": "ESNext", // Next.js typically uses ESNext
    "types": ["node", "jest"], // Add Jest if using
    "jsx": "preserve",
    "allowJs": true,
    "paths": {
      "@/*": ["./src/*"] // <<< KEEP THIS ALIAS
    }
  },
  "exclude": ["node_modules", "dist", "**/*.spec.ts", "**/*.test.ts"],
  // Include necessary files for Next.js build
  "include": ["src/**/*.ts", "src/**/*.tsx", "next-env.d.ts", "contentlayer.config.ts", "next.config.js"]
}
```

Action: Save the file.
Validate Frontend Build {id="manual-frontend-validate-build-pure"}: (#validation)
Action (User - Terminal): nx build frontend.
Troubleshooting: Fix TS errors, Contentlayer paths, Tailwind paths, Next.js config errors. Ignore "Cannot find module @deanmachines/..." for now. Check dist\apps\frontend.
Manual Step: Commit Frontend Migration {id="manual-frontend-commit-pure"}: (#git)
Action (User - Terminal): git add ., git commit -m "feat(frontend): Manual migration of Next.js frontend"

## Phase 4: Manual Shared Libraries & Integration {id="manual-migrate-libs-pure"} (#migration-libs) (#shared-libs)

Manual Step: Create Library Directories {id="manual-libs-create-dirs-pure"}:
Action (User - File Explorer/Terminal): Create:

libs\shared
libs\shared\utils
libs\shared\utils\src
libs\shared\utils\src\lib
libs\shared\types
libs\shared\types\src
libs\shared\types\src\lib
libs\shared\types\src\lib\generated (for later)

Manual Step: Create Library Config Files (shared-utils) {id="manual-libs-config-utils-pure"}: (#config)
Action (User - Editor): Create libs\shared\utils\project.json:

```json
{
  "name": "shared-utils",
  "$schema": "../../node_modules/nx/schemas/project-schema.json",
  "sourceRoot": "libs/shared/utils/src",
  "projectType": "library",
  "tags": ["scope:shared", "type:util"],
  "targets": {
    "build": { // Simple build using tsc
      "executor": "@nx/js:tsc",
      "outputs": ["{options.outputPath}"],
      "options": {
        "outputPath": "dist/libs/shared/utils",
        "main": "libs/shared/utils/src/index.ts",
        "tsConfig": "libs/shared/utils/tsconfig.lib.json",
        "assets": [] // No assets usually for utils
      }
    },
    "lint": { "executor": "@nx/eslint:lint" }
    // Add "test" later
  }
}
```

Action (User - Editor): Create libs\shared\utils\tsconfig.json:

```json
{ // Root tsconfig for the lib, mainly for editor integration
  "extends": "../../tsconfig.base.json",
  "compilerOptions": {
    "types": ["node", "jest"] // If testing with Jest
  },
  "files": [],
  "include": [],
  "references": [ { "path": "./tsconfig.lib.json" }, { "path": "./tsconfig.spec.json" } ] // If testing
}
```

Action (User - Editor): Create libs\shared\utils\tsconfig.lib.json:

```json
{ // Config for building the library
  "extends": "./tsconfig.json",
  "compilerOptions": {
    "outDir": "../../dist/out-tsc",
    "declaration": true, // Generate .d.ts files
    "types": ["node"]
  },
  "include": ["src/**/*.ts"],
  "exclude": ["node_modules", "dist", "**/*.spec.ts", "**/*.test.ts"]
}
```

Action (User - Editor): Create libs\shared\utils\src\index.ts (initially empty or with exports).
Manual Step: Create Library Config Files (shared-types) {id="manual-libs-config-types-pure"}: (#config)
Action (User - Editor): Repeat Step 4.2, creating similar project.json, tsconfig.json, tsconfig.lib.json, and src/index.ts inside libs\shared\types, adjusting names and paths accordingly (e.g., name: "shared-types", outputPath: "dist/libs/shared/types"). Use tags scope:shared, type:types.
Manual Step: Add Path Aliases to tsconfig.base.json {id="manual-libs-add-paths-pure"}: (#config-tsconfig)
Action (User - Editor): Open root tsconfig.base.json. Add the paths for the new libraries:

```json
"compilerOptions": {
  // ... other options ...
  "baseUrl": ".",
  "paths": {
    "@deanmachines/shared-utils": ["libs/shared/utils/src/index.ts"],
    "@deanmachines/shared-types": ["libs/shared/types/src/index.ts"]
    // Add generated path later if needed
    // "@deanmachines/shared-types/generated": ["libs/shared/types/src/lib/generated/api-types.ts"]
  }
}
```

Action: Save tsconfig.base.json.
Manual Step: Migrate Shared Code {id="manual-libs-migrate-code-pure"}:

Action (User - Editor/File Explorer): Move common utils code into libs\shared\utils\src\lib\. Export from index.ts. Move shared types code into libs\shared\types\src\lib\. Export from index.ts.

Action (User - Editor - Find & Replace): Manually update all imports in apps/frontend and apps/backend to use @deanmachines/shared-utils and @deanmachines/shared-types.
Build Shared Libs {id="manual-libs-build-pure"}:

```bash
nx build shared-utils
nx build shared-types
```

Troubleshooting: Fix errors within the libs or their index.ts exports.
Manual Step: Setup API Client Generation Target {id="manual-libs-setup-apigen-pure"}: (#api-contract)
Action (User - Terminal): pnpm add -D openapi-typescript
Action (User - Editor): Create tools\scripts\generate-api-client.ts (copy code from Handbook v2.1, Step 4.5). Verify paths.
Action (User - Editor): Add generate-api-client target to apps\frontend\project.json (using @nx/workspace:run-commands, set outputs).
Action (User - Editor): Add generate-api-client to dependsOn in frontend:build target. Save project.json.
Generate & Integrate API Client {id="manual-libs-run-apigen-pure"}:

Action (User - Terminal): Run the API generation script:

```bash
nx generate-api-client frontend
```

Verification: Check libs\shared-types\src\lib\generated\api-types.ts.
Manual Step (User - Editor): Update frontend code to import/use generated types from @deanmachines/shared-types (potentially from the /generated subpath if you configured it).
Validate Builds {id="manual-libs-validate-builds-pure"}: (#validation)

Action (User - Terminal): Run the following commands to validate builds:

```bash
nx build backend
nx build frontend
```

Troubleshooting: Fix remaining import/type errors. Both builds should now succeed.
Manual Step: Commit Shared Libs Setup {id="manual-libs-commit-pure"}: (#git)
Action (User - Terminal): git add ., git commit -m "feat(libs): Manual setup of shared libs and API generation"

## Phase 5: Manual Testing & Validation {id="manual-migrate-testing-pure"} (#migration-testing) (#testing)

Manual Step: Setup Testing Configs {id="manual-testing-setup-pure"}:
Action (User - Terminal): pnpm add -D @nx/jest jest @types/jest ts-jest jest-environment-jsdom
Action (User - Editor): For each project (frontend, backend, shared-utils, shared-types):
Create jest.config.ts. Populate it using @nx/jest/preset, configure displayName, moduleNameMapper (for aliases), coverageDirectory.
Create tsconfig.spec.json extending ./tsconfig.json and including test files (include: ["src/**/*.spec.ts", ...]).
Add a test target to the project's project.json using @nx/jest:jest executor, pointing to the jest.config.ts.
Action (User - Editor): Example jest.config.ts for frontend:

```ts
// Example test target in project.json
"test": {
  "executor": "@nx/jest:jest",
  "outputs": ["{workspaceRoot}/coverage/{projectRoot}"],
  "options": {
    "jestConfig": "<projectRoot>/jest.config.ts"
  }
}
```

Manual Step: Adapt Test Files {id="manual-testing-adapt-pure"}:
Action (User - Editor): Copy original test files (*.spec.ts, *.test.ts) into the corresponding src directories of the Nx projects.
Action (User - Editor): Update imports within test files to use monorepo paths (@deanmachines/...). Adjust mocks as needed.
Run Linters & Tests {id="manual-testing-run-pure"}: (#validation)

Action (User - Terminal): Run the following commands to validate linting and tests:

```bash
nx run-many --target=lint --all
nx run-many --target=test --all
```

Troubleshooting: Fix lint errors and test failures.
Manual Step: Commit Testing Setup {id="manual-testing-commit-pure"}: (#git)
Action (User - Terminal): git add ., git commit -m "test: Manual configuration for linting and unit tests"

Phase 6: Post-Migration Refinement (Manual) {id="manual-migrate-refinement-pure"} (#migration-refinement)

Manual Step: Refactor Backend {id="manual-refinement-backend-pure"}: (#backend-refactor) (#best-practice)
Action (User - File Explorer/Editor): Incrementally create library structures (libs/mastra-<module>) including project.json, tsconfig.*.json, index.ts. Move code from apps/backend/src. Update imports. Manually add path aliases to tsconfig.base.json. Build libs (nx build mastra-<module>). Ensure apps/backend still builds/serves. Commit each refactor.
Manual Step: Fine-tune Caching {id="manual-refinement-cache-pure"}: (#caching-tuning) (#performance)
Action (User - Terminal/Editor): Use set NX_VERBOSE_LOGGING=true before nx build/test. Analyze hash inputs. Manually edit inputs/outputs in project.json/nx.json.
Manual Step: Configure Module Boundaries {id="manual-refinement-boundaries-pure"}: (#module-boundaries) (#governance)
Action (User - Editor): Add meaningful tags to all project.json. Define depConstraints rules in root .eslintrc.json. Run nx run-many --target=lint --all to check.
Migration Complete (Manual)
This purely manual process requires significant diligence in creating and editing configuration files correctly. Double-check all paths, names, and JSON/YAML syntax. After completing Phase 5, you should have a structurally sound monorepo where individual projects can be built and tested. Phase 6 provides further improvements.
